---
prometheus::pkg_version: latest
prometheus::pkg_name: prometheus
prometheus::config_dir: '/etc/prometheus'
prometheus::manage_service: true
prometheus::manage_firewall: true
prometheus::service_name: prometheus
prometheus::service_enable: true
prometheus::service_ensure: running
prometheus::service_provider: ~

lookup_options:
  prometheus::options:
    merge: deep

prometheus::options:
  global:
    scrape_interval: 15s
    evaluation_interval: 30s
    external_labels:
      monitor: foobar
  rule_files:
    - "first.rules"
    - "/absolute/second.rules"
    - "/my/*.rules"
  scrape_configs:
    - job_name: prometheus
      honor_labels: true
      file_sd_configs:
        - files:
          - foo/*.slow.json
          - foo/*.slow.yml
          - single/file.yml
          refresh_interval: 10m
        - files:
          - bar/*.yaml
      static_configs:
      - targets:
        - 'localhost:9090'
        - 'localhost:9091'
        labels:
          my: label
      relabel_configs:
        - source_labels: [job, __meta_dns_name]
          regex: (.*)some-[regex]
          target_label: job
          replacement: foo-${1}
        - source_labels: [abc]
          target_label:  cde
        - replacement:   static
          target_label:  abc
        - regex:
          replacement:   static
          target_label:  abc
      bearer_token_file: valid_token_file
    - job_name: service-x
      basic_auth:
        username: admin_name
        password: admin_pass
      scrape_interval: 50s
      scrape_timeout: 5s
      sample_limit: 1000
      metrics_path: /my_path
      scheme: https
      dns_sd_configs:
        - refresh_interval: 15s
          names:
          - first.dns.address.domain.com
          - second.dns.address.domain.com
        - names:
          - first.dns.address.domain.com
